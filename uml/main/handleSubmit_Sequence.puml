@startuml
skinparam dpi 300

actor Client
participant "Go API Server" as Server

== handleSubmit 실행 ==
Client -> Server: POST /submit (SignedMessage)
Server -> Server: handleSubmit() 시작
Server -> Server: HTTP 메서드 검증
alt POST 메서드
    Server -> Server: JSON 디코딩
    alt JSON 디코딩 성공
        Server -> Server: 메시지 JSON 마샬링
        alt 마샬링 성공
            Server -> Server: verify() 함수 호출
            alt 서명 검증 성공
                Server -> Server: 뮤텍스 Lock
                Server -> Server: verifiedMessages에 추가
                Server -> Server: 뮤텍스 Unlock
                Server -> Server: 콘솔 로그 출력
                Server --> Client: 201 Created
            else 서명 검증 실패
                Server --> Client: 401 Unauthorized
            end
        else 마샬링 실패
            Server --> Client: 500 Internal Server Error
        end
    else JSON 디코딩 실패
        Server --> Client: 400 Bad Request
    end
else 잘못된 메서드
    Server --> Client: 405 Method Not Allowed
end

@enduml
